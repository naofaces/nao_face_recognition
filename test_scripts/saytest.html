<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>bla</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="http://nao:nao@169.254.66.118/libs/qimessaging/1.0/qimessaging.js"></script>
</head>
<body>
<input type="button" onclick="connect()" value="connect"/>
<input type="button" onclick="speak()" value="speak"/>
<input type="button" onclick="openCamera()" value="openCamera"/>

<script>
var session;
function connect(){
console.log("connect");
session = new QiSession("169.254.66.118");
session.socket().on('connect', function () {
  console.log('QiSession connected!');
  // now you can start using your QiSession
}).on('disconnect', function () {
  console.log('QiSession disconnected!');
});
}

function speak(){
	console.log("in speak");
      	session.service("ALTextToSpeech").done(function(tts)
      {
        tts.say("hello world!");
      });
    }

function openCamera(){
    console.log("in open camera");
    session.service("ALVideoDevice").done(function(video){
	console.log(video);
	console.log("in done");
	var handle = video.subscribeCamera("camera", 0, 0, 3,10); // name, camera, resolution, colourspace, framerate
	console.log(handle);
	var img  = video.getImageRemote(handle).done(function (image){
	console.log("in getimageremote");
	if (image) {
    	var width = image[0];
    	var height = image[1];
    	var imageData = image[6];
    	console.log(width);
    	console.log(height);
    	console.log(imageData);
	}
	}).fail(function (){console.log("failed getimageremote")});
	handle.unsubscribe("camera");
}).fail(function (){console.log("failed service alvideodevice")});
}




</script>


</body>
</html>
